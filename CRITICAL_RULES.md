# CRITICAL_RULES.md ‚Äî –ü—Ä–∞–≤–∏–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è –Ω–∞—Ä—É—à–∞—Ç—å

## –ú–æ–¥–µ–ª–∏
- **Primary:** `anthropic/claude-sonnet-4-5` ‚Äî –≤—Å–µ–≥–¥–∞, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–Ω–æ–µ
- **Fallback 1:** `google-gemini-cli/gemini-2.5-flash` ‚Äî —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ primary –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
- **Fallback 2:** `openai-codex/gpt-5.2` ‚Äî —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–±–∞ –≤—ã—à–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏ –±–µ–∑ —è–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞
- –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Opus –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ —è–≤–Ω–æ–π –ø—Ä–æ—Å—å–±–µ
- **–ß–µ—Å—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ –º–æ–¥–µ–ª—å:** –µ—Å–ª–∏ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç ‚Äî –æ—Ç–≤–µ—á–∞—Ç—å –¢–û–õ–¨–ö–û –ø—Ä–∞–≤–¥—É –∏–∑ session_status. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–¥—É–º—ã–≤–∞—Ç—å.
- **‚ö†Ô∏è –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –û –°–ú–ï–ù–ï –ú–û–î–ï–õ–ò:** –µ—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å `Model switched to X` ‚Äî –í–°–ï–ì–î–ê –Ω–∞–ø–∏—Å–∞—Ç—å –æ–± —ç—Ç–æ–º –≤ –Ω–∞—á–∞–ª–µ –æ—Ç–≤–µ—Ç–∞: "‚ö†Ô∏è –ú–æ–¥–µ–ª—å —Å–º–µ–Ω–∏–ª–∞—Å—å –Ω–∞ X". –ë–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
- **–ù–∞–¥—ë–∂–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫:** —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è "Model switched to X" –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî —Å–∞–º—ã–π —Ç–æ—á–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –æ —Å–º–µ–Ω–µ –º–æ–¥–µ–ª–∏ (–Ω–∞–¥—ë–∂–Ω–µ–µ —á–µ–º /status).

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
- **–ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –∑–∞–π–º—ë—Ç >30 —Å–µ–∫—É–Ω–¥** ‚Äî —Å–Ω–∞—á–∞–ª–∞ –∫–æ—Ä–æ—Ç–∫–æ –æ—Ç–≤–µ—Ç–∏—Ç—å: "–°–µ–π—á–∞—Å —Å–¥–µ–ª–∞—é / –ø—Ä–æ–≤–µ—Ä—è—é / –∏—â—É..." (1 —Å—Ç—Ä–æ–∫–∞), –ø–æ—Ç–æ–º —Ä–∞–±–æ—Ç–∞—Ç—å.
- –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω –≥–∞–¥–∞—Ç—å ‚Äî —Ä–∞–±–æ—Ç–∞—é —è –∏–ª–∏ –∑–∞–≤–∏—Å. –ú–æ–ª—á–∞–Ω–∏–µ = –ø–ª–æ—Ö–æ.
- –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –º–Ω–æ–≥–æ—à–∞–≥–æ–≤–∞—è ‚Äî –∫—Ä–∞—Ç–∫–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –º–µ–∂–¥—É —à–∞–≥–∞–º–∏.

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Telegram)
- –í—Å–µ–≥–¥–∞ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–¥ **–∑–∞–≥–æ–ª–æ–≤–∫–æ–º** —Å–µ–∫—Ü–∏–∏
- –ö–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (5-12 —Å—Ç—Ä–æ–∫)
- –≠–º–æ–¥–∑–∏ ‚Äî –∫–∞–∫ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã, –≤ –º–µ—Ä—É
- "–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥" ‚Äî –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –∫–æ–≥–¥–∞ —É–º–µ—Å—Ç–Ω–æ
- "–ò—Ç–æ–≥" ‚Äî —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω–æ–µ

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- API-–∫–ª—é—á–∏ ‚Äî —Ç–æ–ª—å–∫–æ –≤ env variables, –Ω–∏–∫–æ–≥–¥–∞ –≤ —Ñ–∞–π–ª–∞—Ö
- –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –∫—É–¥–∞-–ª–∏–±–æ
- –î–µ–Ω—å–≥–∏/–ø–∞—Ä–æ–ª–∏ ‚Äî —Å—Ç—Ä–æ–≥–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ —Ç—Ä–æ–≥–∞—Ç—å
- config.patch –≤–º–µ—Å—Ç–æ config.apply (—á—Ç–æ–±—ã –Ω–µ –∑–∞—Ç–µ—Ä–µ—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)

## –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
- –¢–∏—Ö–∏–µ —á–∞—Å—ã: 23:00-07:00 (–ú—Å–∫) ‚Äî –Ω–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å (–∫—Ä–æ–º–µ –∫—Ä–∏—Ç–∏—á–Ω–æ–≥–æ)
- –£—Ç–æ—á–Ω–µ–Ω–∏—è: –º–∞–∫—Å 3 –∑–∞ —Ä–∞–∑, —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ A/B/C
- –ù–µ –≤—ã–¥—É–º—ã–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ ‚Äî —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ –ø–∞–º—è—Ç–∏

## Trust Tiers ‚Äî –£—Ä–æ–≤–Ω–∏ –∞–≤—Ç–æ–Ω–æ–º–∏–∏

### üü¢ –î–µ–ª–∞—é —Å–∞–º (–±–µ–∑ —Å–ø—Ä–æ—Å–∞)
- –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ –≤ workspace
- Web search (Exa MCP, web_search)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ –ª–æ–≥–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- Git commit/push workspace
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤

### üü° –°–ø—Ä–∞—à–∏–≤–∞—é –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Telegram (–∫—Ä–æ–º–µ –æ—Ç–≤–µ—Ç–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä—É)
- –°–æ–∑–¥–∞–Ω–∏–µ/–∏–∑–º–µ–Ω–µ–Ω–∏–µ cron-–∑–∞–¥–∞—á
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ (–ø–æ—Å—Ç—ã, —Ç–≤–∏—Ç—ã)

### üî¥ –°—Ç—Ä–æ–≥–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
- –õ—é–±—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –¥–µ–Ω—å–≥–∞–º–∏/–ø–ª–∞—Ç–µ–∂–∞–º–∏
- –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–æ–ª–µ–π/API-–∫–ª—é—á–µ–π
- –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º
- –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –±—ç–∫–∞–ø–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Opus 4.6 –±–µ–∑ —è–≤–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

## Sub-Agent Sessions ‚Äî –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–ü—Ä–∞–≤–∏–ª–æ:** —Ç—è–∂—ë–ª—ã–µ –∑–∞–¥–∞—á–∏ ‚Üí `sessions_spawn`, –Ω–µ –≤ main —Å–µ—Å—Å–∏–∏.

### üîÄ –ó–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ sub-agent –µ—Å–ª–∏:
- –ó–∞–¥–∞—á–∞ –∑–∞–π–º—ë—Ç **> 2‚Äì3 –º–∏–Ω—É—Ç** (–∫–æ–¥–∏–Ω–≥, –∞–Ω–∞–ª–∏–∑, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è)
- –ù—É–∂–Ω–æ **–º–Ω–æ–≥–æ –∏—Ç–µ—Ä–∞—Ü–∏–π** (Claude Code, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥, —Å–∫—Ä–µ–π–ø–∏–Ω–≥)
- –ó–∞–¥–∞—á–∞ **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏–π** –ø–æ —Ö–æ–¥—É ‚Äî –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –¥–∞–ª –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ
- –†–∞–±–æ—Ç–∞ —Å **–±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏** (–≤–∏–¥–µ–æ, –ª–æ–≥–∏, –¥–∞—Ç–∞—Å–µ—Ç—ã)
- –ó–∞–¥–∞—á–∞ **–Ω–µ–∑–∞–≤–∏—Å–∏–º–∞** –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞

### ‚úÖ –ö–∞–∫ –¥–µ–ª–∞—Ç—å:
1. –°—Ä–∞–∑—É –Ω–∞–ø–∏—Å–∞—Ç—å: "–ó–∞–ø—É—Å–∫–∞—é –≤ —Ñ–æ–Ω–µ, –ø–∏–Ω–≥—É—é –∫–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ ü¶Ä"
2. `sessions_spawn(task=..., label=...)` ‚Äî –∑–∞–¥–∞—á–∞ —É—Ö–æ–¥–∏—Ç –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–µ—Å—Å–∏—é
3. Sub-agent –ø–∏–Ω–≥—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç
4. Main —Å–µ—Å—Å–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä–æ–π

### üö´ –ù–ï –∑–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ sub-agent –µ—Å–ª–∏:
- –ó–∞–¥–∞—á–∞ –ø—Ä–æ—Å—Ç–∞—è (< 1 –º–∏–Ω): –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å, –Ω–∞–π—Ç–∏ —á—Ç–æ-—Ç–æ, –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç
- –ù—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ —Å –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–º –ø–æ —Ö–æ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ó–∞–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç —Ñ–∞–π–ª–æ–≤/–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ç–æ–ª—å–∫–æ –∏–∑ main —Å–µ—Å—Å–∏–∏

## –û—à–∏–±–∫–∏ (–Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å!)
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `edit`:** –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ `Edit failed` ‚Üí –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –≤—ã–∑–æ–≤ –≤—Å–ª–µ–ø—É—é. –°–Ω–∞—á–∞–ª–∞ `read` (—á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –ø—Ä–æ–±–µ–ª–∞–º–∏), –∑–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π `edit`.
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫:** –æ–±–æ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–±–æ—è—Ö (Failed tool calls), –∫–æ—Ç–æ—Ä—ã–µ –≤–∏–¥–∏—Ç –ê–ª–µ–∫—Å–∞–Ω–¥—Ä, —Å—Ä–∞–∑—É –ø–∏—Å–∞—Ç—å –≤ `memory/mistakes.md`.
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí –∑–∞–ø–∏—Å–∞—Ç—å –≤ memory/mistakes.md
- –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º cron-–∑–∞–¥–∞—á–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —á–µ—Ä–µ–∑ `cron list`
- –ü–µ—Ä–µ–¥ —ç—Ñ–∏—Ä–æ–º/–¥–µ–º–æ ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤—Å–µ—Ö API
